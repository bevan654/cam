(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{4462:function(e,s,a){Promise.resolve().then(a.bind(a,51))},9376:function(e,s,a){"use strict";var r=a(5475);a.o(r,"usePathname")&&a.d(s,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(s,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(s,{useSearchParams:function(){return r.useSearchParams}})},51:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return o}});var r=a(7437),n=a(2265),t=a(9376),i=a(7648),c=a(8734),l=a(6672);function o(){let e=(0,t.useRouter)(),{user:s,loading:a,logout:o}=(0,c.a)(),[d,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=localStorage.getItem("campus-angel-cart");if(e)try{let s=JSON.parse(e),a=s.filter(e=>e&&e.id&&e.buildId&&e.name&&"number"==typeof e.price&&"number"==typeof e.quantity&&e.customizations&&"object"==typeof e.customizations).map(e=>({...e,totalPrice:e.totalPrice||e.price*e.quantity}));m(a),a.length!==s.length&&localStorage.setItem("campus-angel-cart",JSON.stringify(a))}catch(e){console.error("Error parsing cart:",e),m([]),localStorage.removeItem("campus-angel-cart")}h(!1)},[]);let j=(e,s)=>{if(s<=0){let s=d.filter(s=>x(s)!==e);m(s),localStorage.setItem("campus-angel-cart",JSON.stringify(s))}else{let a=d.map(a=>x(a)===e?{...a,quantity:s,totalPrice:a.price*s}:a);m(a),localStorage.setItem("campus-angel-cart",JSON.stringify(a))}},x=e=>Array.isArray(e.customizations)?"".concat(e.id,"-").concat(e.buildId,"-").concat(e.customizations.sort().join(",")):"".concat(e.id,"-").concat(e.buildId,"-").concat(Object.entries(e.customizations).sort((e,s)=>{let[a]=e,[r]=s;return a.localeCompare(r)}).map(e=>{let[s,a]=e;return"".concat(s,":").concat(Array.isArray(a)?a.sort().join(","):"")}).join("|")),D={D134:"White Bread",D129:"Italian Bread",D133:"Flatbread",D131:"Wheat Bread",D854:"Multigrain Flatbread",D139:"American Cheese",D138:"Swiss Cheese",D136:"Cheddar Cheese",D518:"Ham",D317:"Steak",D171:"Pickles",D169:"Jalape\xf1os",D170:"Spinach",D163:"Tomatoes",D164:"Onions",D165:"Cucumbers",D166:"Green Peppers",D173:"Banana Peppers",D167:"Black Olives",D162:"Lettuce",D145:"Ranch",D147:"BBQ Sauce",D149:"Hot Sauce",D154:"Honey Mustard",D156:"Chipotle Southwest",D157:"Light Mayonnaise",D146:"Italian Dressing",D141:"Mayonnaise",D151:"Oil & Vinegar",D144:"Ketchup",D174:"Vinegar",D153:"Sweet Onion",D143:"Mustard",D668:"Sriracha",D1478:"Buffalo Sauce",D160:"Pepper",D159:"Salt",2575:"Double Meat",2594:"Extra Bread",2590:"Extra Toppings",3668:"Premium Sauces",2588:"Extra Sauce",2407:"Extra Cheese",2435:"Premium Toppings"},p=e=>{if(Array.isArray(e)){if(0===e.length)return(0,r.jsx)("div",{className:"customization-item",children:(0,r.jsx)("span",{className:"customization-label",children:"No customizations"})});let s={};return e.forEach(e=>{let a=D[e]||"Option ".concat(e),r="Other";e.startsWith("D1")&&["D134","D129","D133","D131","D854"].includes(e)?r="Bread":e.startsWith("D1")&&["D139","D138","D136"].includes(e)?r="Cheese":e.startsWith("D5")||"D317"===e?r="Protein":e.startsWith("D1")&&["D171","D169","D170","D163","D164","D165","D166","D173","D167","D162"].includes(e)?r="Vegetables":e.startsWith("D1")&&["D145","D147","D149","D154","D156","D157","D146","D141","D151","D144","D174","D153","D143","D668","D1478"].includes(e)?r="Sauces":["D160","D159"].includes(e)?r="Seasonings":["2575","2594","2590","3668","2588","2407","2435"].includes(e)&&(r="Extras"),s[r]||(s[r]=[]),s[r].push(a)}),Object.entries(s).map(e=>{let[s,a]=e;return(0,r.jsxs)("div",{className:"customization-item",children:[(0,r.jsxs)("span",{className:"customization-label",children:[s,":"]}),(0,r.jsx)("span",{className:"customization-values",children:a.join(", ")})]},s)})}if(!e||0===Object.keys(e).length)return(0,r.jsx)("div",{className:"customization-item",children:(0,r.jsx)("span",{className:"customization-label",children:"No customizations"})});let s=Object.entries(e).filter(e=>{let[s,a]=e;return Array.isArray(a)&&a.length>0});return 0===s.length?(0,r.jsx)("div",{className:"customization-item",children:(0,r.jsx)("span",{className:"customization-label",children:"No customizations"})}):s.map(e=>{let[s,a]=e,n=s.charAt(0).toUpperCase()+s.slice(1);return(0,r.jsxs)("div",{className:"customization-item",children:[(0,r.jsxs)("span",{className:"customization-label",children:[n,":"]}),(0,r.jsx)("span",{className:"customization-values",children:a.join(", ")})]},s)})},N=e=>e.totalPrice||e.price*e.quantity,g=d.reduce((e,s)=>e+N(s),0),f=d.length>0?2.99:0;return u?(0,r.jsx)("div",{className:"App",children:(0,r.jsxs)("div",{className:"cart-hero-bg",children:[(0,r.jsx)(l.AI,{user:s,loading:a,onLogout:o}),(0,r.jsx)("main",{className:"cart-main",children:(0,r.jsx)("div",{className:"cart-container-modern",children:(0,r.jsxs)("div",{className:"cart-loading",children:[(0,r.jsx)("div",{className:"loading-spinner",children:"⏳"}),(0,r.jsx)("h2",{children:"Loading your cart..."})]})})})]})}):0===d.length?(0,r.jsx)("div",{className:"App",children:(0,r.jsxs)("div",{className:"cart-hero-bg",children:[(0,r.jsx)(l.AI,{user:s,loading:a,onLogout:o}),(0,r.jsx)("main",{className:"cart-main",children:(0,r.jsx)("div",{className:"cart-container-modern",children:(0,r.jsxs)("div",{className:"empty-cart-modern",children:[(0,r.jsx)("div",{className:"empty-cart-icon",children:"\uD83D\uDED2"}),(0,r.jsx)("h1",{children:"Your cart is empty"}),(0,r.jsx)("p",{children:"Looks like you haven't added any items to your cart yet. Discover delicious food from campus restaurants!"}),(0,r.jsx)(i.default,{href:"/restaurants",className:"btn-cart-primary",children:"\uD83C\uDF7D️ Browse Restaurants"})]})})})]})}):(0,r.jsxs)("div",{className:"App",children:[(0,r.jsxs)("div",{className:"cart-hero-bg",children:[(0,r.jsx)(l.AI,{user:s,loading:a,onLogout:o}),(0,r.jsx)("section",{className:"cart-hero",children:(0,r.jsx)("div",{className:"cart-hero-container",children:(0,r.jsxs)("div",{className:"cart-hero-content",children:[(0,r.jsx)("h1",{children:"\uD83D\uDED2 Your Cart"}),(0,r.jsx)("p",{children:"Review your delicious selections and checkout when ready!"}),(0,r.jsxs)("div",{className:"cart-hero-stats",children:[(0,r.jsxs)("div",{className:"modern-stat",children:[(0,r.jsx)("span",{className:"modern-stat-number",children:d.length}),(0,r.jsx)("span",{className:"modern-stat-label",children:"Items"})]}),(0,r.jsxs)("div",{className:"modern-stat",children:[(0,r.jsxs)("span",{className:"modern-stat-number",children:["$",g.toFixed(0)]}),(0,r.jsx)("span",{className:"modern-stat-label",children:"Subtotal"})]}),(0,r.jsxs)("div",{className:"modern-stat",children:[(0,r.jsx)("span",{className:"modern-stat-number",children:"20min"}),(0,r.jsx)("span",{className:"modern-stat-label",children:"Est. Delivery"})]})]})]})})})]}),(0,r.jsx)("main",{className:"cart-main",children:(0,r.jsxs)("div",{className:"cart-container-modern",children:[(0,r.jsxs)("div",{className:"cart-header-modern",children:[(0,r.jsx)("h2",{children:"Cart Items"}),(0,r.jsx)("button",{onClick:()=>{m([]),localStorage.removeItem("campus-angel-cart")},className:"btn-clear-cart",children:"\uD83D\uDDD1️ Clear Cart"})]}),(0,r.jsxs)("div",{className:"cart-layout-modern",children:[(0,r.jsx)("div",{className:"cart-items-modern",children:d.map((e,s)=>{let a=x(e);return(0,r.jsxs)("div",{className:"cart-item-modern",children:[(0,r.jsxs)("div",{className:"cart-item-header",children:[(0,r.jsx)("h3",{className:"item-name-modern",children:e.name}),(0,r.jsxs)("div",{className:"item-price-modern",children:["$",e.price.toFixed(2)," each"]})]}),(0,r.jsx)("div",{className:"item-customizations-modern",children:p(e.customizations)}),(0,r.jsxs)("div",{className:"cart-item-footer",children:[(0,r.jsxs)("div",{className:"quantity-controls-modern",children:[(0,r.jsx)("button",{onClick:()=>j(a,e.quantity-1),className:"quantity-btn-modern minus",disabled:e.quantity<=1,children:"−"}),(0,r.jsx)("span",{className:"quantity-modern",children:e.quantity}),(0,r.jsx)("button",{onClick:()=>j(a,e.quantity+1),className:"quantity-btn-modern plus",children:"+"})]}),(0,r.jsxs)("div",{className:"item-total-modern",children:["$",N(e).toFixed(2)]}),(0,r.jsx)("button",{onClick:()=>{window.confirm('Remove "'.concat(e.name,'" from cart?'))&&j(a,0)},className:"remove-btn-modern",title:"Remove ".concat(e.name," from cart"),"aria-label":"Remove ".concat(e.name," from cart"),children:"\uD83D\uDDD1️"})]})]},a)})}),(0,r.jsxs)("div",{className:"order-summary-modern",children:[(0,r.jsxs)("div",{className:"summary-header",children:[(0,r.jsx)("h2",{children:"Order Summary"}),(0,r.jsx)("div",{className:"summary-icon",children:"\uD83D\uDCCB"})]}),(0,r.jsxs)("div",{className:"summary-details-modern",children:[(0,r.jsxs)("div",{className:"summary-line-modern",children:[(0,r.jsxs)("span",{children:["Items (",d.length,")"]}),(0,r.jsxs)("span",{children:["$",g.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"summary-line-modern",children:[(0,r.jsx)("span",{children:"Delivery Fee"}),(0,r.jsxs)("span",{children:["$",f.toFixed(2)]})]}),(0,r.jsx)("div",{className:"summary-divider"}),(0,r.jsxs)("div",{className:"summary-line-modern total",children:[(0,r.jsx)("span",{children:"Total"}),(0,r.jsxs)("span",{children:["$",(g+f).toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"delivery-info-modern",children:[(0,r.jsx)("h4",{children:"\uD83D\uDE9A Delivery Details"}),(0,r.jsxs)("div",{className:"delivery-details",children:[(0,r.jsx)("p",{children:"\uD83D\uDD52 20-30 minutes"}),(0,r.jsx)("p",{children:"\uD83D\uDCCD Campus delivery only"})]})]}),(0,r.jsxs)("div",{className:"cart-actions",children:[(0,r.jsx)("button",{onClick:()=>e.push("/checkout"),className:"btn-checkout-modern",disabled:0===d.length,children:"\uD83D\uDED2 Proceed to Checkout"}),(0,r.jsx)(i.default,{href:"/restaurants",className:"btn-continue-shopping",children:"← Continue Shopping"})]})]})]})]})})]})}},6672:function(e,s,a){"use strict";a.d(s,{AI:function(){return t},Gu:function(){return i},Te:function(){return l},ZG:function(){return c}});var r=a(7437),n=a(7648);function t(e){let{user:s,loading:a,onLogout:t}=e;return(0,r.jsx)("header",{className:"modern-header",children:(0,r.jsxs)("nav",{className:"modern-nav",children:[(0,r.jsx)(n.default,{href:"/",className:"modern-logo",children:"Campus Angel"}),(0,r.jsxs)("ul",{className:"modern-nav-links",children:[(0,r.jsx)("li",{children:(0,r.jsx)(n.default,{href:"/",children:"Home"})}),(0,r.jsx)("li",{children:(0,r.jsx)(n.default,{href:"/restaurants",children:"Restaurants"})}),(0,r.jsx)("li",{children:(0,r.jsx)(n.default,{href:"/account",children:"Account"})}),(0,r.jsx)("li",{children:(0,r.jsx)(n.default,{href:"/cart",children:"Cart"})})]}),(0,r.jsx)("div",{className:"modern-auth-buttons",children:a?(0,r.jsx)("div",{className:"auth-loading",children:"⏳"}):s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.default,{href:"/account",className:"btn btn-outline-modern",children:"My Account"}),(0,r.jsx)(n.default,{href:"/cart",className:"btn btn-primary-modern",children:"Cart"}),(0,r.jsx)("button",{onClick:t,className:"btn btn-secondary-modern",children:"Logout"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.default,{href:"/login",className:"btn btn-outline-modern",children:"Log In"}),(0,r.jsx)(n.default,{href:"/register",className:"btn btn-primary-modern",children:"Sign Up"})]})})]})})}function i(e){let{message:s="Loading...",submessage:a,className:n="hero-bg"}=e;return(0,r.jsx)("div",{className:"App",children:(0,r.jsxs)("div",{className:n,children:[(0,r.jsx)(t,{}),(0,r.jsx)("main",{className:"loading-main",children:(0,r.jsx)("div",{className:"loading-container-modern",children:(0,r.jsxs)("div",{className:"loading-content",children:[(0,r.jsx)("div",{className:"loading-spinner",children:"⏳"}),(0,r.jsx)("h2",{children:s}),a&&(0,r.jsx)("p",{children:a})]})})})]})})}function c(e){let{message:s="Authentication Required",submessage:a="You must be logged in to access this page.",className:i="hero-bg"}=e;return(0,r.jsx)("div",{className:"App",children:(0,r.jsxs)("div",{className:i,children:[(0,r.jsx)(t,{}),(0,r.jsx)("main",{className:"auth-required-main",children:(0,r.jsx)("div",{className:"auth-required-container-modern",children:(0,r.jsxs)("div",{className:"auth-required-content",children:[(0,r.jsx)("div",{className:"auth-icon",children:"\uD83D\uDD12"}),(0,r.jsx)("h2",{children:s}),(0,r.jsx)("p",{children:a}),(0,r.jsxs)("div",{className:"auth-actions-modern",children:[(0,r.jsx)(n.default,{href:"/login",className:"btn-auth-primary",children:"\uD83D\uDD11 Login"}),(0,r.jsx)(n.default,{href:"/register",className:"btn-auth-secondary",children:"\uD83D\uDCDD Register"})]})]})})})]})})}function l(e){let{title:s="Something went wrong",message:a,primaryAction:i,secondaryAction:c,className:l="hero-bg"}=e;return(0,r.jsx)("div",{className:"App",children:(0,r.jsxs)("div",{className:l,children:[(0,r.jsx)(t,{}),(0,r.jsx)("main",{className:"error-main",children:(0,r.jsx)("div",{className:"error-container-modern",children:(0,r.jsxs)("div",{className:"error-content",children:[(0,r.jsx)("div",{className:"error-icon",children:"❌"}),(0,r.jsx)("h2",{children:s}),(0,r.jsx)("p",{children:a}),(0,r.jsxs)("div",{className:"error-actions",children:[i&&(0,r.jsxs)(n.default,{href:i.href,className:"btn-error-primary",children:[i.icon," ",i.text]}),c&&(0,r.jsxs)(n.default,{href:c.href,className:"btn-error-secondary",children:[c.icon," ",c.text]})]})]})})})]})})}},8734:function(e,s,a){"use strict";a.d(s,{a:function(){return t}});var r=a(2265),n=a(9376);function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{requireAuth:s=!1,redirectToLogin:a=!1}=e,t=(0,n.useRouter)(),[i,c]=(0,r.useState)({user:null,loading:!0,error:null}),l=(0,r.useCallback)(async()=>{try{let e=localStorage.getItem("accessToken");if(!e){c({user:null,loading:!1,error:null}),s&&a&&t.push("/login");return}let r=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(r.ok){let e=await r.json();c({user:e.user,loading:!1,error:null})}else if(401===r.status){let e=localStorage.getItem("refreshToken");if(e)try{let s=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(s.ok){let e=await s.json();localStorage.setItem("accessToken",e.session.accessToken),localStorage.setItem("refreshToken",e.session.refreshToken);let a=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e.session.accessToken),"Content-Type":"application/json"}});if(a.ok){let e=await a.json();c({user:e.user,loading:!1,error:null})}else o()}else o()}catch(e){console.error("Token refresh error:",e),o()}else o()}else o()}catch(e){console.error("Auth check error:",e),c({user:null,loading:!1,error:"Failed to check authentication"}),s&&a&&t.push("/login")}},[s,a,t]),o=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),c({user:null,loading:!1,error:null}),s&&a&&t.push("/login")};return(0,r.useEffect)(()=>{l()},[l]),{user:i.user,loading:i.loading,error:i.error,isAuthenticated:!!i.user,logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),c({user:null,loading:!1,error:null}),t.push("/")},refreshAuth:()=>{c(e=>({...e,loading:!0})),l()}}}}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=4462)}),_N_E=e.O()}]);