(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[781],{7120:function(e,a,s){Promise.resolve().then(s.bind(s,6950))},9376:function(e,a,s){"use strict";var r=s(5475);s.o(r,"usePathname")&&s.d(a,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(a,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(a,{useSearchParams:function(){return r.useSearchParams}})},6950:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return o}});var r=s(7437),n=s(2265),t=s(9376),l=s(7648),c=s(4114);function o(){(0,t.useRouter)();let[e,a]=(0,n.useState)(""),[s,o]=(0,n.useState)(!1),[i,d]=(0,n.useState)(""),[h,u]=(0,n.useState)(!1),m=async a=>{a.preventDefault(),o(!0),d("");try{let a=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),s=await a.json();a.ok?u(!0):d(s.error||"Failed to send password reset email")}catch(e){d("Network error. Please try again.")}finally{o(!1)}};return h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{}),(0,r.jsx)("main",{style:{marginTop:"80px",padding:"2rem"},children:(0,r.jsx)("div",{className:"auth-container",children:(0,r.jsxs)("div",{className:"auth-card",children:[(0,r.jsxs)("div",{className:"auth-header",children:[(0,r.jsx)("div",{className:"success-icon",children:"✅"}),(0,r.jsx)("h1",{children:"Check Your Email"}),(0,r.jsxs)("p",{children:["We've sent a password reset link to ",(0,r.jsx)("strong",{children:e})]})]}),(0,r.jsxs)("div",{className:"success-message",children:[(0,r.jsx)("p",{children:"Please check your email and click the link to reset your password. The link will expire in 1 hour."}),(0,r.jsx)("p",{children:"If you don't see the email, check your spam folder."})]}),(0,r.jsxs)("div",{className:"auth-footer",children:[(0,r.jsx)(l.default,{href:"/login",className:"btn btn-primary",children:"Back to Login"}),(0,r.jsxs)("p",{className:"auth-switch",children:["Remember your password?"," ",(0,r.jsx)(l.default,{href:"/login",className:"auth-link",children:"Sign in here"})]})]})]})})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{}),(0,r.jsx)("main",{style:{marginTop:"80px",padding:"2rem"},children:(0,r.jsx)("div",{className:"auth-container",children:(0,r.jsxs)("div",{className:"auth-card",children:[(0,r.jsxs)("div",{className:"auth-header",children:[(0,r.jsx)("h1",{children:"Forgot Password"}),(0,r.jsx)("p",{children:"Enter your email address and we'll send you a link to reset your password"})]}),i&&(0,r.jsx)("div",{className:"error-message",children:i}),(0,r.jsxs)("form",{onSubmit:m,className:"auth-form",children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:e,onChange:e=>a(e.target.value),required:!0,placeholder:"Enter your email",className:"form-input"})]}),(0,r.jsx)("button",{type:"submit",disabled:s,className:"btn btn-primary auth-submit",children:s?"Sending...":"Send Reset Link"})]}),(0,r.jsxs)("div",{className:"auth-footer",children:[(0,r.jsx)(l.default,{href:"/login",className:"back-to-login",children:"← Back to Login"}),(0,r.jsxs)("p",{className:"auth-switch",children:["Don't have an account?"," ",(0,r.jsx)(l.default,{href:"/register",className:"auth-link",children:"Sign up here"})]})]})]})})})]})}},4114:function(e,a,s){"use strict";s.d(a,{Z:function(){return c}});var r=s(7437),n=s(2265),t=s(9376),l=s(7648);function c(){let e=(0,t.useRouter)(),a=(0,t.usePathname)(),[s,c]=(0,n.useState)(!1),[o,i]=(0,n.useState)(null),[d,h]=(0,n.useState)(!0),u=e=>{i(e)};(0,n.useEffect)(()=>(window.updateNavbarUser=u,()=>{delete window.updateNavbarUser}),[]),(0,n.useEffect)(()=>{(async()=>{let e=localStorage.getItem("accessToken"),a=localStorage.getItem("refreshToken");if(!e){h(!1),i(null);return}try{let s=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(s.ok){let e=await s.json();i(e.user)}else if(401===s.status&&a)try{let e=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:a})});if(e.ok){let a=await e.json();localStorage.setItem("accessToken",a.session.accessToken),localStorage.setItem("refreshToken",a.session.refreshToken);let s=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(a.session.accessToken),"Content-Type":"application/json"}});if(s.ok){let e=await s.json();i(e.user)}else localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),i(null)}else localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),i(null)}catch(e){console.error("Token refresh error:",e),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),i(null)}else localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),i(null)}catch(e){console.error("Auth check error:",e),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),i(null)}finally{h(!1)}})()},[a]);let m=async()=>{let a=localStorage.getItem("accessToken");if(a)try{await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:a})})}catch(e){console.error("Logout error:",e)}i(null),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),e.push("/")},f="/login"===a||"/register"===a;return(0,r.jsx)("header",{className:"site-header",children:(0,r.jsx)("div",{className:"container",children:(0,r.jsxs)("div",{className:"navbar",children:[(0,r.jsx)("div",{className:"navbar-brand",children:(0,r.jsxs)(l.default,{href:"/",className:"logo",children:[(0,r.jsx)("span",{className:"logo-icon",children:"\uD83D\uDC7C"}),(0,r.jsx)("span",{className:"logo-text",children:"Campus Angel"})]})}),(0,r.jsxs)("nav",{className:"navbar-nav ".concat(s?"open":""),children:[(0,r.jsx)(l.default,{href:"/",className:"nav-link",children:"Home"}),(0,r.jsx)(l.default,{href:"/restaurants",className:"nav-link",children:"Restaurants"}),(0,r.jsx)(l.default,{href:"/about",className:"nav-link",children:"About"}),(0,r.jsx)(l.default,{href:"/contact",className:"nav-link",children:"Contact"})]}),(0,r.jsxs)("div",{className:"navbar-actions",children:[d?(0,r.jsx)("div",{className:"auth-loading",children:(0,r.jsx)("span",{className:"loading-spinner",children:"⏳"})}):f?null:(0,r.jsx)(r.Fragment,{children:o?(0,r.jsx)("div",{className:"user-menu",children:(0,r.jsxs)("div",{className:"user-info",children:[(0,r.jsxs)("div",{className:"user-details",children:[(0,r.jsxs)("span",{className:"user-greeting",children:["Hello, ",o.firstName,"!"]}),(0,r.jsx)("span",{className:"user-email",children:o.email})]}),(0,r.jsxs)("div",{className:"user-actions",children:[(0,r.jsx)(l.default,{href:"/account",className:"btn btn-secondary account-btn",children:"My Account"}),(0,r.jsx)("button",{className:"btn btn-secondary logout-btn",onClick:m,children:"Logout"})]})]})}):(0,r.jsxs)("div",{className:"auth-buttons",children:[(0,r.jsx)(l.default,{href:"/login",className:"btn btn-secondary",children:"Login"}),(0,r.jsx)(l.default,{href:"/register",className:"btn btn-primary",children:"Register"})]})}),(0,r.jsxs)(l.default,{href:"/cart",className:"btn btn-secondary cart-btn",children:[(0,r.jsx)("span",{className:"cart-icon",children:"\uD83D\uDED2"}),(0,r.jsx)("span",{className:"cart-text",children:"Cart"})]}),(0,r.jsx)("button",{className:"mobile-menu-toggle",onClick:()=>c(!s),"aria-label":"Toggle mobile menu",children:(0,r.jsx)("span",{className:"hamburger ".concat(s?"open":"")})})]})]})})})}}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=7120)}),_N_E=e.O()}]);