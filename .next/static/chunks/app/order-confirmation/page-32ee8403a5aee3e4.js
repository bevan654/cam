(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{3790:function(e,s,a){Promise.resolve().then(a.bind(a,8445))},8445:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return o}});var n=a(7437),r=a(2265),i=a(9376),l=a(7648),c=a(8734),t=a(6672);function d(){(0,i.useRouter)();let e=(0,i.useSearchParams)(),{user:s,loading:a,logout:d}=(0,c.a)(),[o,m]=(0,r.useState)(null),[h,u]=(0,r.useState)(null),[j,x]=(0,r.useState)(!0),[N,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{let s=e.get("orderId");s?(m(s),f(s)):(x(!1),v("No order ID provided"))},[e]);let f=async e=>{try{let s=localStorage.getItem("accessToken");if(!s){v("Authentication required"),x(!1);return}let a=await fetch("/api/validate-order?orderId=".concat(e),{headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(!a.ok){404===a.status?v("Order not found or access denied"):401===a.status?v("Authentication failed"):v("Failed to validate order"),x(!1);return}let n=await a.json();u(n.order),x(!1)}catch(e){console.error("Error validating order:",e),v("Failed to validate order"),x(!1)}};return j?(0,n.jsx)(t.Gu,{message:"Validating Order...",submessage:"Please wait while we verify your order details.",className:"confirmation-hero-bg"}):N||!h?(0,n.jsx)("div",{className:"App",children:(0,n.jsxs)("div",{className:"confirmation-hero-bg",children:[(0,n.jsx)(t.AI,{user:s,loading:a,onLogout:d}),(0,n.jsx)("main",{className:"confirmation-main",children:(0,n.jsx)("div",{className:"confirmation-container-modern",children:(0,n.jsxs)("div",{className:"confirmation-error",children:[(0,n.jsx)("div",{className:"error-icon",children:"❌"}),(0,n.jsx)("h2",{children:"Order Not Found"}),(0,n.jsx)("p",{children:N||"Unable to find order details. Please check your order history or contact support."}),(0,n.jsxs)("div",{className:"error-actions",children:[(0,n.jsx)(l.default,{href:"/account",className:"btn-error-primary",children:"\uD83D\uDCCB View Orders"}),(0,n.jsx)(l.default,{href:"/restaurants",className:"btn-error-secondary",children:"\uD83C\uDF7D️ Order Again"})]})]})})})]})}):(0,n.jsxs)("div",{className:"App",children:[(0,n.jsxs)("div",{className:"confirmation-hero-bg",children:[(0,n.jsx)(t.AI,{user:s,loading:a,onLogout:d}),(0,n.jsx)("section",{className:"confirmation-hero",children:(0,n.jsx)("div",{className:"confirmation-hero-container",children:(0,n.jsxs)("div",{className:"confirmation-hero-content",children:[(0,n.jsx)("div",{className:"success-icon",children:"✅"}),(0,n.jsx)("h1",{children:"Order Confirmed!"}),(0,n.jsxs)("p",{className:"order-id",children:["Order #",h.id]}),(0,n.jsx)("p",{children:"Thank you for your order! We've received your payment and your food is being prepared."}),(0,n.jsxs)("div",{className:"confirmation-hero-stats",children:[(0,n.jsxs)("div",{className:"modern-stat",children:[(0,n.jsxs)("span",{className:"modern-stat-number",children:["$",h.total.toFixed(0)]}),(0,n.jsx)("span",{className:"modern-stat-label",children:"Total Paid"})]}),(0,n.jsxs)("div",{className:"modern-stat",children:[(0,n.jsx)("span",{className:"modern-stat-number",children:"20min"}),(0,n.jsx)("span",{className:"modern-stat-label",children:"Est. Delivery"})]}),(0,n.jsxs)("div",{className:"modern-stat",children:[(0,n.jsx)("span",{className:"modern-stat-number",children:"✓"}),(0,n.jsx)("span",{className:"modern-stat-label",children:"Confirmed"})]})]})]})})})]}),(0,n.jsx)("main",{className:"confirmation-main",children:(0,n.jsx)("div",{className:"confirmation-container-modern",children:(0,n.jsxs)("div",{className:"confirmation-layout",children:[(0,n.jsxs)("div",{className:"order-details-modern",children:[(0,n.jsxs)("div",{className:"details-section",children:[(0,n.jsxs)("div",{className:"section-header-confirmation",children:[(0,n.jsx)("h2",{children:"\uD83D\uDCCB Order Summary"}),(0,n.jsx)("span",{className:"status-badge-modern ".concat(h.status),children:h.status.toUpperCase()})]}),(0,n.jsxs)("div",{className:"summary-grid",children:[(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("div",{className:"summary-icon",children:"\uD83D\uDCB0"}),(0,n.jsxs)("div",{className:"summary-content",children:[(0,n.jsx)("span",{className:"summary-label",children:"Total Amount"}),(0,n.jsxs)("span",{className:"summary-value",children:["$",h.total.toFixed(2)]})]})]}),(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("div",{className:"summary-icon",children:"\uD83D\uDCB3"}),(0,n.jsxs)("div",{className:"summary-content",children:[(0,n.jsx)("span",{className:"summary-label",children:"Payment Method"}),(0,n.jsx)("span",{className:"summary-value",children:h.payment_method})]})]}),(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("div",{className:"summary-icon",children:"\uD83D\uDCC5"}),(0,n.jsxs)("div",{className:"summary-content",children:[(0,n.jsx)("span",{className:"summary-label",children:"Order Date"}),(0,n.jsx)("span",{className:"summary-value",children:new Date(h.created_at).toLocaleDateString()})]})]}),(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("div",{className:"summary-icon",children:"\uD83D\uDCE6"}),(0,n.jsxs)("div",{className:"summary-content",children:[(0,n.jsx)("span",{className:"summary-label",children:"Order ID"}),(0,n.jsxs)("span",{className:"summary-value",children:["#",h.id.slice(0,8)]})]})]})]})]}),(0,n.jsxs)("div",{className:"details-section",children:[(0,n.jsx)("div",{className:"section-header-confirmation",children:(0,n.jsx)("h2",{children:"\uD83C\uDFE2 Delivery Details"})}),(0,n.jsxs)("div",{className:"delivery-card",children:[(0,n.jsxs)("div",{className:"delivery-info-item",children:[(0,n.jsx)("span",{className:"delivery-label",children:"Building:"}),(0,n.jsx)("span",{className:"delivery-value",children:h.delivery_details.building})]}),(0,n.jsxs)("div",{className:"delivery-info-item",children:[(0,n.jsx)("span",{className:"delivery-label",children:"Room/Area:"}),(0,n.jsx)("span",{className:"delivery-value",children:h.delivery_details.room})]}),h.delivery_details.instructions&&(0,n.jsxs)("div",{className:"delivery-info-item",children:[(0,n.jsx)("span",{className:"delivery-label",children:"Instructions:"}),(0,n.jsx)("span",{className:"delivery-value",children:h.delivery_details.instructions})]})]})]}),(0,n.jsxs)("div",{className:"details-section",children:[(0,n.jsx)("div",{className:"section-header-confirmation",children:(0,n.jsx)("h2",{children:"\uD83D\uDCDE Contact Information"})}),(0,n.jsxs)("div",{className:"contact-card",children:[(0,n.jsxs)("div",{className:"contact-info-item",children:[(0,n.jsx)("span",{className:"contact-label",children:"Name:"}),(0,n.jsx)("span",{className:"contact-value",children:h.contact_info.name})]}),(0,n.jsxs)("div",{className:"contact-info-item",children:[(0,n.jsx)("span",{className:"contact-label",children:"Phone:"}),(0,n.jsx)("span",{className:"contact-value",children:h.contact_info.phone})]}),(0,n.jsxs)("div",{className:"contact-info-item",children:[(0,n.jsx)("span",{className:"contact-label",children:"Email:"}),(0,n.jsx)("span",{className:"contact-value",children:h.contact_info.email})]})]})]})]}),(0,n.jsxs)("div",{className:"action-panel-modern",children:[(0,n.jsxs)("div",{className:"delivery-timeline",children:[(0,n.jsx)("h3",{children:"\uD83D\uDE9A Delivery Timeline"}),(0,n.jsxs)("div",{className:"timeline-item",children:[(0,n.jsx)("div",{className:"timeline-icon confirmed",children:"✓"}),(0,n.jsxs)("div",{className:"timeline-content",children:[(0,n.jsx)("span",{className:"timeline-title",children:"Order Confirmed"}),(0,n.jsx)("span",{className:"timeline-desc",children:"Payment received and order sent to restaurant"})]})]}),(0,n.jsxs)("div",{className:"timeline-item upcoming",children:[(0,n.jsx)("div",{className:"timeline-icon",children:"\uD83D\uDC68‍\uD83C\uDF73"}),(0,n.jsxs)("div",{className:"timeline-content",children:[(0,n.jsx)("span",{className:"timeline-title",children:"Preparing Food"}),(0,n.jsx)("span",{className:"timeline-desc",children:"Restaurant is preparing your order"})]})]}),(0,n.jsxs)("div",{className:"timeline-item upcoming",children:[(0,n.jsx)("div",{className:"timeline-icon",children:"\uD83D\uDEB4"}),(0,n.jsxs)("div",{className:"timeline-content",children:[(0,n.jsx)("span",{className:"timeline-title",children:"Out for Delivery"}),(0,n.jsx)("span",{className:"timeline-desc",children:"Driver will pick up and deliver your order"})]})]}),(0,n.jsxs)("div",{className:"timeline-item upcoming",children:[(0,n.jsx)("div",{className:"timeline-icon",children:"\uD83C\uDF89"}),(0,n.jsxs)("div",{className:"timeline-content",children:[(0,n.jsx)("span",{className:"timeline-title",children:"Delivered!"}),(0,n.jsx)("span",{className:"timeline-desc",children:"Enjoy your meal"})]})]})]}),(0,n.jsxs)("div",{className:"action-buttons",children:[(0,n.jsx)(l.default,{href:"/order-tracking?orderId=".concat(h.id),className:"btn-track-order-modern",children:"\uD83D\uDCCD Track Order"}),(0,n.jsx)(l.default,{href:"/account",className:"btn-view-orders",children:"\uD83D\uDCCB View All Orders"})]}),(0,n.jsxs)("div",{className:"support-card",children:[(0,n.jsx)("h4",{children:"Need Help?"}),(0,n.jsx)("p",{children:"Our support team is here to help!"}),(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"\uD83D\uDCE7 support@campusangel.com"})}),(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"\uD83D\uDCF1 1-800-CAMPUS"})})]})]})]})})})]})}function o(){return(0,n.jsx)(r.Suspense,{fallback:(0,n.jsx)(t.Gu,{}),children:(0,n.jsx)(d,{})})}},6672:function(e,s,a){"use strict";a.d(s,{AI:function(){return i},Gu:function(){return l},Te:function(){return t},ZG:function(){return c}});var n=a(7437),r=a(7648);function i(e){let{user:s,loading:a,onLogout:i}=e;return(0,n.jsx)("header",{className:"modern-header",children:(0,n.jsxs)("nav",{className:"modern-nav",children:[(0,n.jsx)(r.default,{href:"/",className:"modern-logo",children:"Campus Angel"}),(0,n.jsxs)("ul",{className:"modern-nav-links",children:[(0,n.jsx)("li",{children:(0,n.jsx)(r.default,{href:"/",children:"Home"})}),(0,n.jsx)("li",{children:(0,n.jsx)(r.default,{href:"/restaurants",children:"Restaurants"})}),(0,n.jsx)("li",{children:(0,n.jsx)(r.default,{href:"/account",children:"Account"})}),(0,n.jsx)("li",{children:(0,n.jsx)(r.default,{href:"/cart",children:"Cart"})})]}),(0,n.jsx)("div",{className:"modern-auth-buttons",children:a?(0,n.jsx)("div",{className:"auth-loading",children:"⏳"}):s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.default,{href:"/account",className:"btn btn-outline-modern",children:"My Account"}),(0,n.jsx)(r.default,{href:"/cart",className:"btn btn-primary-modern",children:"Cart"}),(0,n.jsx)("button",{onClick:i,className:"btn btn-secondary-modern",children:"Logout"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.default,{href:"/login",className:"btn btn-outline-modern",children:"Log In"}),(0,n.jsx)(r.default,{href:"/register",className:"btn btn-primary-modern",children:"Sign Up"})]})})]})})}function l(e){let{message:s="Loading...",submessage:a,className:r="hero-bg"}=e;return(0,n.jsx)("div",{className:"App",children:(0,n.jsxs)("div",{className:r,children:[(0,n.jsx)(i,{}),(0,n.jsx)("main",{className:"loading-main",children:(0,n.jsx)("div",{className:"loading-container-modern",children:(0,n.jsxs)("div",{className:"loading-content",children:[(0,n.jsx)("div",{className:"loading-spinner",children:"⏳"}),(0,n.jsx)("h2",{children:s}),a&&(0,n.jsx)("p",{children:a})]})})})]})})}function c(e){let{message:s="Authentication Required",submessage:a="You must be logged in to access this page.",className:l="hero-bg"}=e;return(0,n.jsx)("div",{className:"App",children:(0,n.jsxs)("div",{className:l,children:[(0,n.jsx)(i,{}),(0,n.jsx)("main",{className:"auth-required-main",children:(0,n.jsx)("div",{className:"auth-required-container-modern",children:(0,n.jsxs)("div",{className:"auth-required-content",children:[(0,n.jsx)("div",{className:"auth-icon",children:"\uD83D\uDD12"}),(0,n.jsx)("h2",{children:s}),(0,n.jsx)("p",{children:a}),(0,n.jsxs)("div",{className:"auth-actions-modern",children:[(0,n.jsx)(r.default,{href:"/login",className:"btn-auth-primary",children:"\uD83D\uDD11 Login"}),(0,n.jsx)(r.default,{href:"/register",className:"btn-auth-secondary",children:"\uD83D\uDCDD Register"})]})]})})})]})})}function t(e){let{title:s="Something went wrong",message:a,primaryAction:l,secondaryAction:c,className:t="hero-bg"}=e;return(0,n.jsx)("div",{className:"App",children:(0,n.jsxs)("div",{className:t,children:[(0,n.jsx)(i,{}),(0,n.jsx)("main",{className:"error-main",children:(0,n.jsx)("div",{className:"error-container-modern",children:(0,n.jsxs)("div",{className:"error-content",children:[(0,n.jsx)("div",{className:"error-icon",children:"❌"}),(0,n.jsx)("h2",{children:s}),(0,n.jsx)("p",{children:a}),(0,n.jsxs)("div",{className:"error-actions",children:[l&&(0,n.jsxs)(r.default,{href:l.href,className:"btn-error-primary",children:[l.icon," ",l.text]}),c&&(0,n.jsxs)(r.default,{href:c.href,className:"btn-error-secondary",children:[c.icon," ",c.text]})]})]})})})]})})}},8734:function(e,s,a){"use strict";a.d(s,{a:function(){return i}});var n=a(2265),r=a(9376);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{requireAuth:s=!1,redirectToLogin:a=!1}=e,i=(0,r.useRouter)(),[l,c]=(0,n.useState)({user:null,loading:!0,error:null}),t=(0,n.useCallback)(async()=>{try{let e=localStorage.getItem("accessToken");if(!e){c({user:null,loading:!1,error:null}),s&&a&&i.push("/login");return}let n=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(n.ok){let e=await n.json();c({user:e.user,loading:!1,error:null})}else if(401===n.status){let e=localStorage.getItem("refreshToken");if(e)try{let s=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(s.ok){let e=await s.json();localStorage.setItem("accessToken",e.session.accessToken),localStorage.setItem("refreshToken",e.session.refreshToken);let a=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e.session.accessToken),"Content-Type":"application/json"}});if(a.ok){let e=await a.json();c({user:e.user,loading:!1,error:null})}else d()}else d()}catch(e){console.error("Token refresh error:",e),d()}else d()}else d()}catch(e){console.error("Auth check error:",e),c({user:null,loading:!1,error:"Failed to check authentication"}),s&&a&&i.push("/login")}},[s,a,i]),d=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),c({user:null,loading:!1,error:null}),s&&a&&i.push("/login")};return(0,n.useEffect)(()=>{t()},[t]),{user:l.user,loading:l.loading,error:l.error,isAuthenticated:!!l.user,logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),c({user:null,loading:!1,error:null}),i.push("/")},refreshAuth:()=>{c(e=>({...e,loading:!0})),t()}}}}},function(e){e.O(0,[448,971,117,744],function(){return e(e.s=3790)}),_N_E=e.O()}]);