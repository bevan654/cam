"use strict";(()=>{var e={};e.id=70,e.ids=[70],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1282:e=>{e.exports=require("child_process")},4770:e=>{e.exports=require("crypto")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},1764:e=>{e.exports=require("util")},7907:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>x,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var n={};r.r(n),r.d(n,{POST:()=>u});var a=r(9303),o=r(8716),i=r(670),s=r(7070);let p=new(r(8472)).Z(process.env.STRIPE_SECRET_KEY,{apiVersion:"2023-10-16"});async function u(e){try{let{items:t,total:r}=await e.json();if(!t||!Array.isArray(t)||0===t.length)return s.NextResponse.json({error:"Invalid items array"},{status:400});if(!r||"number"!=typeof r||r<=0)return s.NextResponse.json({error:"Invalid total amount"},{status:400});let n=t.reduce((e,t)=>{let r=t.totalPrice||t.price*t.quantity;return e+r},0)+2.99;if(Math.abs(r-n)>.01)return console.error("Price mismatch:",{clientTotal:r,serverTotal:n}),s.NextResponse.json({error:"Price validation failed"},{status:400});let a=await p.paymentIntents.create({amount:Math.round(100*n),currency:"aud",metadata:{items_count:t.length.toString(),delivery_fee:"2.99"}});return s.NextResponse.json({clientSecret:a.client_secret,paymentIntentId:a.id,amount:n})}catch(e){return console.error("Error creating payment intent:",e),s.NextResponse.json({error:"Failed to create payment intent"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/create-payment-intent/route",pathname:"/api/create-payment-intent",filename:"route",bundlePath:"app/api/create-payment-intent/route"},resolvedPagePath:"C:\\Users\\Bevan\\uni-food-delivery\\src\\app\\api\\create-payment-intent\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m}=c,y="/api/create-payment-intent/route";function x(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972,472],()=>r(7907));module.exports=n})();