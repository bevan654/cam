(()=>{var e={};e.id=218,e.ids=[218],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5579:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>c,pages:()=>p,routeModule:()=>u,tree:()=>a}),t(3501),t(6139),t(2029),t(5866);var s=t(3191),i=t(8716),o=t(7922),n=t.n(o),d=t(5231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);t.d(r,l);let a=["",{children:["driver",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3501)),"C:\\Users\\Bevan\\uni-food-delivery\\src\\app\\driver\\orders\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,6139)),"C:\\Users\\Bevan\\uni-food-delivery\\src\\app\\driver\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,2029)),"C:\\Users\\Bevan\\uni-food-delivery\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],p=["C:\\Users\\Bevan\\uni-food-delivery\\src\\app\\driver\\orders\\page.tsx"],c="/driver/orders/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/driver/orders/page",pathname:"/driver/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:a}})},2620:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},8094:()=>{},9993:(e,r,t)=>{Promise.resolve().then(t.bind(t,9658))},4914:(e,r,t)=>{Promise.resolve().then(t.bind(t,4319))},9658:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});var s=t(326),i=t(7577),o=t(5047);function n({children:e}){let[r,t]=(0,i.useState)(!1),[n,d]=(0,i.useState)(!0);(0,o.useRouter)();let l=(0,o.usePathname)();return n?s.jsx("div",{style:{padding:"20px"},children:"Loading..."}):"/driver/login"===l||r?s.jsx(s.Fragment,{children:e}):null}},4319:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var s=t(326),i=t(7577),o=t(434);let n=["placed","confirmed","preparing","delivered"];function d(){let[e,r]=(0,i.useState)([]),[t,d]=(0,i.useState)(!0),[l,a]=(0,i.useState)(null),[p,c]=(0,i.useState)(10),x=async()=>{try{let e=localStorage.getItem("accessToken");if(!e){console.error("No access token found");return}let t=await fetch("/api/driver/orders",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){let e=((await t.json()).orders||[]).filter(e=>"delivered"!==e.status);r(e)}else console.error("Failed to fetch orders")}catch(e){console.error("Error fetching orders:",e)}finally{d(!1)}},u=async(e,t)=>{try{a(e);let s=localStorage.getItem("accessToken");if(!s){alert("Authentication required");return}console.log("Updating order status:",{orderId:e,newStatus:t});let i=await fetch("/api/driver/update-order-status",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({orderId:e,status:t})});if(i.ok){let s=await i.json();console.log("API response:",s),r(r=>r.map(r=>r.id===e?{...r,status:t,updated_at:new Date().toISOString()}:r)),alert(`Order status updated to: ${t}`)}else{let e=await i.json();console.error("API error response:",e),alert(`Failed to update order: ${e.error}`)}}catch(e){console.error("Error updating order status:",e),alert("Failed to update order status")}finally{a(null)}},h=e=>{r(r=>r.filter(r=>r.id!==e))},g=e=>({placed:"#6c757d",confirmed:"#17a2b8",preparing:"#ffc107",delivered:"#28a745"})[e]||"#6c757d",f=e=>({placed:"\uD83D\uDCDD",confirmed:"✅",preparing:"\uD83D\uDC68‍\uD83C\uDF73",delivered:"\uD83C\uDFAF"})[e]||"❓",y=e=>new Date(e).toLocaleString(),m=e=>e&&0!==Object.keys(e).length?s.jsx("div",{style:{marginTop:"5px"},children:Object.entries(e).map(([e,r])=>(0,s.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginLeft:"10px"},children:[(0,s.jsxs)("strong",{children:[e,":"]})," ",Array.isArray(r)?r.join(", "):r]},e))}):s.jsx("span",{style:{color:"#666",fontStyle:"italic"},children:"No customizations"});return t?s.jsx("div",{style:{padding:"20px",textAlign:"center"},children:s.jsx("p",{children:"Loading orders..."})}):(0,s.jsxs)("div",{style:{padding:"20px"},children:[s.jsx("div",{style:{marginBottom:"20px"},children:s.jsx(o.default,{href:"/driver",style:{color:"#007bff",textDecoration:"none"},children:"← Back to Dashboard"})}),s.jsx("h1",{children:"Driver Orders"}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",padding:"10px 15px",backgroundColor:"#f8f9fa",borderRadius:"6px",border:"1px solid #e9ecef"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"\uD83D\uDD04 Auto-refresh:"}),(0,s.jsxs)("span",{style:{fontSize:"16px",fontWeight:"bold",color:p<=3?"#dc3545":"#28a745"},children:["Next poll in ",p,"s"]})]}),s.jsx("button",{onClick:()=>{x(),c(10)},disabled:t,style:{padding:"6px 12px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:t?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",opacity:t?.6:1},children:t?"Refreshing...":"\uD83D\uDD04 Refresh Now"})]}),0===e.length?s.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:s.jsx("p",{children:"No active orders found"})}):s.jsx("div",{style:{display:"grid",gap:"20px"},children:e.map(e=>(0,s.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:"8px",padding:"20px",backgroundColor:"white",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"15px",paddingBottom:"15px",borderBottom:"1px solid #eee"},children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{style:{margin:"0 0 5px 0",color:"#333"},children:["Order #",e.id]}),s.jsx("p",{style:{margin:"0",color:"#666",fontSize:"14px"},children:y(e.created_at)})]}),s.jsx("div",{style:{textAlign:"right"},children:(0,s.jsxs)("span",{style:{padding:"6px 12px",backgroundColor:g(e.status),color:"white",borderRadius:"20px",fontSize:"12px",fontWeight:"bold"},children:[f(e.status)," ",e.status.replace(/_/g," ")]})})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[(0,s.jsxs)("div",{children:[s.jsx("h4",{style:{margin:"0 0 10px 0",color:"#555"},children:"Customer Info"}),(0,s.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[s.jsx("strong",{children:"Name:"})," ",e.contact_info?.name||"N/A"]}),(0,s.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[s.jsx("strong",{children:"Phone:"})," ",e.contact_info?.phone||"N/A"]}),(0,s.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[s.jsx("strong",{children:"Email:"})," ",e.contact_info?.email||"N/A"]})]}),(0,s.jsxs)("div",{children:[s.jsx("h4",{style:{margin:"0 0 10px 0",color:"#555"},children:"Delivery Details"}),(0,s.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[s.jsx("strong",{children:"Building:"})," ",e.delivery_details?.building||"N/A"]}),(0,s.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[s.jsx("strong",{children:"Room:"})," ",e.delivery_details?.room||"N/A"]}),(0,s.jsxs)("p",{style:{margin:"5px 0",fontSize:"14px"},children:[s.jsx("strong",{children:"Instructions:"})," ",e.delivery_details?.instructions||"None"]})]})]}),(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[s.jsx("h4",{style:{margin:"0 0 10px 0",color:"#555"},children:"Items"}),(0,s.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:"15px",borderRadius:"6px",border:"1px solid #e9ecef"},children:[e.items?.map((r,t)=>s.jsxs("div",{style:{padding:"10px 0",borderBottom:t<e.items.length-1?"1px solid #dee2e6":"none"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[s.jsxs("span",{style:{fontWeight:"bold"},children:[r.name||r.title||"Unknown Item"," x",r.quantity]}),s.jsxs("span",{style:{fontWeight:"bold"},children:["$",(r.price*r.quantity).toFixed(2)]})]}),r.customizations&&s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:m(r.customizations)})]},t)),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 0 0 0",borderTop:"2px solid #dee2e6",fontWeight:"bold",fontSize:"16px"},children:[s.jsx("span",{children:"Total:"}),(0,s.jsxs)("span",{children:["$",e.total?.toFixed(2)||"0.00"]})]})]})]}),(0,s.jsxs)("div",{children:[s.jsx("h4",{style:{margin:"0 0 10px 0",color:"#555"},children:"Update Status"}),s.jsx("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"15px"},children:n.map(r=>s.jsx("button",{onClick:()=>{console.log("Button clicked for status:",r),u(e.id,r)},disabled:l===e.id||e.status===r,style:{padding:"8px 16px",backgroundColor:e.status===r?g(r):"#f8f9fa",color:e.status===r?"white":"#333",border:`1px solid ${e.status===r?g(r):"#dee2e6"}`,borderRadius:"6px",cursor:l===e.id?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",opacity:l===e.id?.6:1},children:l===e.id&&e.status===r?"Updating...":r.replace(/_/g," ")},r))}),"delivered"===e.status&&(0,s.jsxs)("div",{style:{borderTop:"1px solid #eee",paddingTop:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{style:{color:"#666",fontSize:"14px"},children:"Order delivered - you can hide it from your view"}),s.jsx("button",{onClick:()=>h(e.id),style:{padding:"8px 16px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"Hide Order"})]})]})]},e.id))})]})}},6139:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(8570).createProxy)(String.raw`C:\Users\Bevan\uni-food-delivery\src\app\driver\layout.tsx#default`)},3501:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(8570).createProxy)(String.raw`C:\Users\Bevan\uni-food-delivery\src\app\driver\orders\page.tsx#default`)},2029:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d,metadata:()=>n});var s=t(9510),i=t(5384),o=t.n(i);t(1141);let n={title:"Campus Angel - University Food Delivery",description:"Your campus food angel is here! Order delicious food from campus restaurants with fast delivery."};function d({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:o().className,children:e})})}},1141:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,349,496],()=>t(5579));module.exports=s})();